{"version":3,"sources":["load.js"],"names":["globalData","require","wave","canvasHeight","canvasWidth","waveHeight","waveWidth","xOffset","speed","levelHeight","cc","Class","extends","Component","properties","loadingBar","Graphics","startBtn","Button","init","console","log","drawWave","ctx","startX","clear","time","moveTo","x","y","Math","sin","lineTo","fill","onStartBtnClicked","director","loadScene","onLoad","node","active","start","preloadScene","update"],"mappings":";;;;;;AAAA;AACA,IAAIA,aAAaC,QAAQ,YAAR,CAAjB;AACA;AACA,IAAIC,OAAO;AACPC,kBAAc,GADP,EACa;AACpBC,iBAAa,GAFN,EAEW;AAClBC,gBAAY,EAHL,EAGS;AAChBC,eAAW,IAJJ,EAIS;AAChBC,aAAS,CALF,EAKK;AACZC,WAAO,GANA,EAMK;AACZC,iBAAa,EAPN,CAOS;AAPT,CAAX;;AAUAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAYL,GAAGM,QADP;AAERC,kBAAUP,GAAGQ;AAFL,KAHP;;AAQLC,UAAM,gBAAU;AACZC,gBAAQC,GAAR,CAAY,MAAZ,EAAoBrB,UAApB;AACAA,mBAAWmB,IAAX;AACA;AACH,KAZI;;AAcLG,cAAU,oBAAW;AACjB,YAAIC,MAAM,KAAKR,UAAf;AACA,YAAMS,SAAS,CAAf;AACAD,YAAIE,KAAJ;;AAEA,aAAKC,IAAL,IAAa,CAAb;AACAxB,aAAKK,OAAL,IAAgBL,KAAKM,KAArB;AACAN,aAAKO,WAAL,IAAoB,GAApB;AACAc,YAAII,MAAJ,CAAW,CAAX,EAAc,CAAd;AACA,aAAK,IAAIC,IAAIJ,MAAb,EAAqBI,IAAIJ,SAAStB,KAAKE,WAAvC,EAAoDwB,KAAK,KAAK1B,KAAKE,WAAnE,EAAgF;AAC5E,gBAAMyB,IAAI3B,KAAKG,UAAL,GAAkByB,KAAKC,GAAL,CAAS,CAACP,SAASI,CAAV,IAAe1B,KAAKI,SAApB,GAAgCJ,KAAKK,OAA9C,CAAlB,GAA2EL,KAAKO,WAA1F;AACAc,gBAAIS,MAAJ,CAAWJ,CAAX,EAAcC,CAAd;AACH;AACDN,YAAIS,MAAJ,CAAW9B,KAAKE,WAAhB,EAA6B,CAA7B;AACAmB,YAAIS,MAAJ,CAAWR,MAAX,EAAmB,CAAnB;AACAD,YAAIU,IAAJ;AACH,KA9BI;;AAgCLC,uBAAmB,6BAAW;AAC1Bd,gBAAQC,GAAR,CAAY,oBAAZ;AACAX,WAAGyB,QAAH,CAAYC,SAAZ,CAAsB,aAAtB;AACH,KAnCI;AAoCL;;AAEAC,UAtCK,oBAsCK;AACN,aAAKlB,IAAL;AACA,aAAKO,IAAL,GAAY,CAAZ;AACA,aAAKT,QAAL,CAAcqB,IAAd,CAAmBC,MAAnB,GAA4B,KAA5B;AACH,KA1CI;AA4CLC,SA5CK,mBA4CI;AACL9B,WAAGyB,QAAH,CAAYM,YAAZ,CAAyB,aAAzB,EAAwC,YAAY;AAChD/B,eAAGW,GAAH,CAAO,sBAAP;AACH,SAFD;AAGH,KAhDI;AAkDLqB,UAlDK,oBAkDK;AACN,YAAIxC,KAAKO,WAAL,GAAmB,GAAvB,EAA4B;AACxB,iBAAKa,QAAL;AACH,SAFD,MAGK;AACD,iBAAKL,QAAL,CAAcqB,IAAd,CAAmBC,MAAnB,GAA4B,IAA5B;AACH;AACJ;AAzDI,CAAT","file":"load.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\load\\JS","sourcesContent":["// 加载数据\r\nvar globalData = require(\"globalData\");\r\n// 加载框水波对象\r\nvar wave = {\r\n    canvasHeight: 200,  // 画面高度\r\n    canvasWidth: 300, // 画面宽度\r\n    waveHeight: 10, // 水波高度\r\n    waveWidth: 0.02,// 水波宽度\r\n    xOffset: 0, // 波浪的横坐标偏移\r\n    speed: 0.1, // 波浪速度\r\n    levelHeight: 10 // 水平线\r\n}\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        loadingBar: cc.Graphics,\r\n        startBtn: cc.Button\r\n    },\r\n\r\n    init: function(){\r\n        console.log(\"init\", globalData);\r\n        globalData.init();\r\n        // console.log(globalData.species);\r\n    },\r\n\r\n    drawWave: function() {\r\n        var ctx = this.loadingBar;\r\n        const startX = 0;\r\n        ctx.clear();\r\n\r\n        this.time += 1;\r\n        wave.xOffset += wave.speed;\r\n        wave.levelHeight += 0.2;\r\n        ctx.moveTo(0, 0);\r\n        for (let x = startX; x < startX + wave.canvasWidth; x += 20 / wave.canvasWidth) {\r\n            const y = wave.waveHeight * Math.sin((startX + x) * wave.waveWidth + wave.xOffset) + wave.levelHeight;\r\n            ctx.lineTo(x, y);\r\n        }\r\n        ctx.lineTo(wave.canvasWidth, 0);\r\n        ctx.lineTo(startX, 0);\r\n        ctx.fill();\r\n    },\r\n\r\n    onStartBtnClicked: function() {\r\n        console.log('turn to adopt page');\r\n        cc.director.loadScene(\"portrayPage\");\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.init();\r\n        this.time = 0;\r\n        this.startBtn.node.active = false;\r\n    },\r\n\r\n    start () {\r\n        cc.director.preloadScene(\"portrayPage\", function () {\r\n            cc.log(\"Next scene preloaded\");\r\n        });\r\n    },\r\n\r\n    update () {\r\n        if (wave.levelHeight < 150) {\r\n            this.drawWave();\r\n        }\r\n        else {\r\n            this.startBtn.node.active = true;\r\n        }\r\n    },\r\n});\r\n"]}