{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\shop\\js/assets\\shop\\js\\shopCopy.js"],"names":["globalData","require","Commodity","id","name","categoryID","categoryName","price","isOwnFlag","_isShow","_isOwn","_isSoldOut","cartAmount","showCategory","isSelling","cc","Class","extends","Component","properties","btnSound","default","url","AudioClip","commodityArray","cart","showedCommodityArray","selectedCommodityIndex","selectedCategory","selectedSubCategory","subCategory","Node","_isSubCateHidden","coin","Label","growthLevel","cost","shopListView","ScrollView","cateBtn1","Button","cateBtn2","cateBtn3","cateBtn4","subCateBtn1","subCateBtn2","subCateBtn3","subCateBtn4","subCateBtn5","subCateBtn6","subCateBtn7","exitBtn","prompt","_isPromptHidden","promptUnitPrice","get","_promptUnitPrice","set","value","promptUnitPriceLabel","string","promptQuantity","_promptQuantity","promptQuantityLabel","promptTotalPrice","_promptTotalPrice","promptTotalPriceLabel","promptShowPic","Sprite","promptExitBtn","promptCancelBtn","promptConfirmBtn","promptIncreaseBtn","promptDecreaseBtn","commodityShowBlock","Layout","cartSpriteArray","onClickCategory","event","raw","soundVolume","btnSoundID","audioEngine","play","active","console","log","target","modifyShopItemType","loadShopItem","onClickSubCategory","confirm","push","date","Date","year","getFullYear","month","getMonth","dat","getDate","hour","getHours","minute","getMinutes","second","getSeconds","timeStr","data","self","serverAddr","HttpHelper","httpPost","_data","openPrompt","i","length","element","exit","showedCommodityArra","director","loadScene","goHome","promptItem","promptSp","action","node","spriteFrame","fin","fadeTo","runAction","scale","s","scaleTo","easing","easeBackOut","fout","fadeOut","easeBackIn","end_func","callFunc","bind","seq","sequence","onPromptDecreaseBtnClicked","onPromptIncreaseBtnClicked","initShop","itemIDArray","split","itemNameArray","categoryIDArray","categoryNameArray","priceArray","isOwnArray","ownFlagArray","index","commodity","type","destroyAllChildren","itemNum","picName","loader","loadRes","SpriteFrame","err","sp","Prefab","prf","commodityItem","instantiate","getComponent","init","on","zIndex","addChild","height","scrollToTop","onLoad","start"],"mappings":"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","file":"shopCopy.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\shop\\js","sourcesContent":["/*\r\n  author: qll\r\n  time: 2019/12/2\r\n*/\r\n// 加载数据\r\nvar globalData = require(\"globalData\");\r\n\r\nfunction Commodity(id, name, categoryID, categoryName, price, isOwnFlag) {\r\n\tthis.id = id;\r\n\tthis.name = name;\r\n\tthis.categoryID = categoryID;\r\n\tthis.categoryName = categoryName;\r\n\tthis.price = price;\r\n\tthis._isShow = false;\r\n\tthis._isOwn = isOwnFlag;\r\n\tthis._isSoldOut = false;\r\n\tthis.cartAmount = 0;\r\n\r\n\tthis.showCategory = function (categoryID) {\r\n\t\tif (this.categoryID == categoryID) {\r\n\t\t\tthis._isShow = true;\r\n\t\t} else {\r\n\t\t\tthis._isShow = false;\r\n\t\t}\r\n\t\tthis.isSelling();\r\n\t};\r\n\t// 判断是否商店是否继续销售\r\n\tthis.isSelling = function () {\r\n\t\tif (this._isOwn == 1 && (this.categoryID != 1 && this.categoryID != 2)) {\r\n\t\t\tthis._isSoldOut = true;\r\n\t\t}\r\n\t};\r\n};\r\n\r\n\r\ncc.Class({\r\n\textends: cc.Component,\r\n\r\n\tproperties: {\r\n\t\t//音效\r\n        btnSound: {//按键音\r\n            default: null,\r\n            url: cc.AudioClip\r\n        },\r\n\t\tcommodityArray: [],  // 全部商品对象数组\r\n\t\tcart: [],  // 购物车中商品对象数组\r\n\t\tshowedCommodityArray: [],  // 框中展示出的商品对象数组\r\n\t\tselectedCommodityIndex: 0, // 选中的商品在商品数组中的序列\r\n\t\tselectedCategory: 0,//选定的类别ID\r\n\t\tselectedSubCategory: 0,//选定的子类别ID\r\n\r\n\t\tsubCategory: cc.Node, // 子类标签节点\r\n\t\t_isSubCateHidden: true,  //标志位：子类别标签是否隐藏\r\n\r\n\t\t//以下为对页面的控制数据\r\n\t\tcoin: cc.Label, //用户金币值\r\n\t\tgrowthLevel: cc.Label, //用户等级\r\n\r\n\t\tcost: cc.Label, //一次购买操作的花费\r\n\r\n\t\tshopListView: cc.ScrollView,\r\n\r\n\t\tcateBtn1: cc.Button, // 商品类别1按钮\r\n\t\tcateBtn2: cc.Button, // 商品类别2按钮\r\n\t\tcateBtn3: cc.Button, // 商品类别3按钮\r\n\t\tcateBtn4: cc.Button, // 商品类别4按钮\r\n\r\n\t\tsubCateBtn1: cc.Button, // 小屋装饰子类别1按钮\r\n\t\tsubCateBtn2: cc.Button, // 小屋装饰子类别2按钮\r\n\t\tsubCateBtn3: cc.Button, // 小屋装饰子类别3按钮\r\n\t\tsubCateBtn4: cc.Button, // 小屋装饰子类别4按钮\r\n\t\tsubCateBtn5: cc.Button, // 小屋装饰子类别5按钮\r\n\t\tsubCateBtn6: cc.Button, // 小屋装饰子类别6按钮\r\n\t\tsubCateBtn7: cc.Button, // 小屋装饰子类别7按钮\r\n\r\n\t\texitBtn: cc.Button, // 退出按钮\r\n\r\n\t\tprompt: cc.Node, // 提示框节点\r\n\t\t_isPromptHidden: true,  // 标志位：提示框是否隐藏\r\n\t\tpromptUnitPrice: { // 提示框显示单价\r\n\t\t\tget: function () {\r\n\t\t\t\treturn this._promptUnitPrice;\r\n\t\t\t},\r\n\t\t\tset: function (value) {\r\n\t\t\t\tthis._promptUnitPrice = value;\r\n\t\t\t\tthis.promptUnitPriceLabel.string = this._promptUnitPrice + '';\r\n\t\t\t}\r\n\t\t},\r\n\t\tpromptQuantity: { // 提示框显示数量\r\n\t\t\tget: function () {\r\n\t\t\t\treturn this._promptQuantity;\r\n\t\t\t},\r\n\t\t\tset: function (value) {\r\n\t\t\t\tif (value < 0) {\r\n\t\t\t\t\tvalue = 0;\r\n\t\t\t\t}\r\n\t\t\t\tthis._promptQuantity = value;\r\n\t\t\t\tthis.promptQuantityLabel.string = this._promptQuantity + '';\r\n\t\t\t}\r\n\t\t},\r\n\t\tpromptTotalPrice: { // 提示框显示总价\r\n\t\t\tget: function () {\r\n\t\t\t\treturn this._promptTotalPrice;\r\n\t\t\t},\r\n\t\t\tset: function () {\r\n\t\t\t\tthis._promptTotalPrice = this._promptUnitPrice * this.promptQuantity;\r\n\t\t\t\tthis.promptTotalPriceLabel.string = this._promptTotalPrice + '';\r\n\t\t\t}\r\n\t\t},\r\n\t\tpromptShowPic: cc.Sprite, // 提示框展示的商品图片\r\n\t\tpromptUnitPriceLabel: cc.Label, // 提示框单价显示标签\r\n\t\tpromptTotalPriceLabel: cc.Label, // 提示框总价显示标签\r\n\t\tpromptQuantityLabel: cc.Label, // 提示框数量显示标签\r\n\t\tpromptExitBtn: cc.Button, // 退出提示框按钮\r\n\t\tpromptCancelBtn: cc.Button, // 提示框取消按钮\r\n\t\tpromptConfirmBtn: cc.Button, // 提示框确认按钮\r\n\t\tpromptIncreaseBtn: cc.Button, // 提示框增加数量按钮\r\n\t\tpromptDecreaseBtn: cc.Button, // 提示框减少数量按钮\r\n\r\n\t\tcommodityShowBlock: cc.Layout, //商店中商品展示框\r\n\t\tcartSpriteArray: cc.Sprite * 25, //商店中展示的商品\r\n\r\n\t},\r\n\r\n\t//点击类别按钮的事件处理函数\r\n\tonClickCategory: function (event) {\r\n\t\t//播放按键音\r\n        this.btnSound=cc.url.raw('resources/sound/button/1.mp3');\r\n        var soundVolume = 0.5;\r\n        var btnSoundID = cc.audioEngine.play(this.btnSound, false, soundVolume);\r\n        //var btnSoundID = cc.audioEngine.play(this.btnSound, false, GlobalData.soundVolume);\r\n\t\tthis.subCategory.active = false;\r\n\t\tconsole.log('category ' + event.target.name + ' was clicked!');\r\n\t\tif (event.target.name == 'btn1') {\r\n\t\t\tthis.selectedCategory = 1;\r\n\t\t\tthis.modifyShopItemType(1);\r\n\t\t\tthis.loadShopItem();\r\n\t\t} else if (event.target.name == 'btn2') {\r\n\t\t\tthis.selectedCategory = 2;\r\n\t\t\tthis.modifyShopItemType(2);\r\n\t\t\tthis.loadShopItem();\r\n\t\t} else if (event.target.name == 'btn3') {\r\n\t\t\tthis.selectedCategory = 3;\r\n\t\t\tthis.modifyShopItemType(3);\r\n\t\t\tthis.loadShopItem();\r\n\t\t\tthis.subCategory.active = true;\r\n\t\t} else {\r\n\t\t\tthis.selectedCategory = 4;\r\n\t\t\tthis.modifyShopItemType(10);\r\n\t\t\tthis.loadShopItem();\r\n\t\t}\r\n\t},\r\n\r\n\t//点击子类别按钮的事件处理函数\r\n\tonClickSubCategory: function (event) {\r\n\t\t//播放按键音\r\n        this.btnSound=cc.url.raw('resources/sound/button/1.mp3');\r\n        var soundVolume = 0.5;\r\n        var btnSoundID = cc.audioEngine.play(this.btnSound, false, soundVolume);\r\n        //var btnSoundID = cc.audioEngine.play(this.btnSound, false, GlobalData.soundVolume);\r\n\t\tconsole.log('sub category ' + event.target.name + ' was clicked!');\r\n\t\tif (event.target.name == 'btn1') {\r\n\t\t\tthis.modifyShopItemType(3);\r\n\t\t\tthis.loadShopItem()\r\n\t\t} else if (event.target.name == 'btn2') {\r\n\t\t\tthis.modifyShopItemType(4);\r\n\t\t\tthis.loadShopItem();\r\n\t\t} else if (event.target.name == 'btn3') {\r\n\t\t\tthis.modifyShopItemType(5);\r\n\t\t\tthis.loadShopItem();\r\n\t\t} else if (event.target.name == 'btn4') {\r\n\t\t\tthis.modifyShopItemType(6);\r\n\t\t\tthis.loadShopItem();\r\n\t\t} else if (event.target.name == 'btn5') {\r\n\t\t\tthis.modifyShopItemType(7);\r\n\t\t\tthis.loadShopItem();\r\n\t\t} else if (event.target.name == 'btn6') {\r\n\t\t\tthis.modifyShopItemType(8);\r\n\t\t\tthis.loadShopItem();\r\n\t\t} else {\r\n\t\t\tthis.modifyShopItemType(9);\r\n\t\t\tthis.loadShopItem();\r\n\t\t}\r\n\t},\r\n\r\n\t//点击确认按钮的事件处理函数\r\n\tconfirm: function () {\r\n\t\t//播放按键音\r\n        this.btnSound=cc.url.raw('resources/sound/button/1.mp3');\r\n        var soundVolume = 0.5;\r\n        var btnSoundID = cc.audioEngine.play(this.btnSound, false, soundVolume);\r\n        //var btnSoundID = cc.audioEngine.play(this.btnSound, false, GlobalData.soundVolume);\r\n\t\tif (this.promptQuantity > 0) {\r\n\t\t\tconsole.log(\"buy \" + this.commodityArray[this.selectedCommodityIndex].name + ' ' + this.promptQuantity);\r\n\t\t\t// 选中商品的加入购物车\r\n\t\t\tthis.commodityArray[this.selectedCommodityIndex]._isOwn = true;\r\n\r\n\t\t\tthis.commodityArray[this.selectedCommodityIndex].cartAmount = this.promptQuantity;\r\n\t\t\tthis.commodityArray[this.selectedCommodityIndex].isSelling(); // 购买该商品之后重新判断能否出现在商店\r\n\t\t\tthis.cart.push(this.commodityArray[this.selectedCommodityIndex]);\r\n\r\n\t\t\tlet date = new Date();\r\n\t\t\tlet year = date.getFullYear(); //获取当前年份   \r\n\t\t\tlet month = date.getMonth() + 1; //获取当前月份   \r\n\t\t\tlet dat = date.getDate(); //获取当前日    \r\n\t\t\tlet hour = date.getHours(); //获取小时   \r\n\t\t\tlet minute = date.getMinutes(); //获取分钟   \r\n\t\t\tlet second = date.getSeconds(); //获取秒   \r\n\t\t\tlet timeStr = year + '-' + month + '-' + dat + ' ' + hour + ':' + minute + ':' + second;\r\n\r\n\t\t\tvar data = {\r\n\t\t\t\t\"userID\": \"nqEsLYOCtdRUkx4Ovn8bhDUmnBHB3DdEncp0z7ApU1\",\r\n\t\t\t\t\"operationTime\": timeStr,\r\n\t\t\t\t\"categoryID\": this.commodityArray[this.selectedCommodityIndex].categoryID,\r\n\t\t\t\t\"itemID\": this.commodityArray[this.selectedCommodityIndex].id,\r\n\t\t\t\t\"number\": this.promptQuantity,\r\n\t\t\t};\r\n\t\t\tvar self = this;\r\n\t\t\tvar serverAddr = 'https://www.llquruc.top/petGame/php/buy.php';\r\n\r\n\t\t\tHttpHelper.httpPost(serverAddr, data, function (_data) {\r\n\t\t\t\tif (_data != -1) {\r\n\t\t\t\t\tconsole.log(\"success!\");\r\n\t\t\t\t\t// 未处理返回值，\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.openPrompt();\r\n\t\t\tthis.loadShopItem();\r\n\t\t}\r\n\t\tconsole.log(\"--------fellows are in cart--------\");\r\n\t\tfor (let i = 0; i < this.cart.length; i++) {\r\n\t\t\tconst element = this.cart[i];\r\n\t\t\tconsole.log(\"shop name: \" + element.name + \",amount: \" + element.cartAmount);\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t//点击关闭商店按钮的事件处理函数，返回主界面\r\n\texit: function () {\r\n\t\t//播放按键音\r\n        this.btnSound=cc.url.raw('resources/sound/button/1.mp3');\r\n        var soundVolume = 0.5;\r\n        var btnSoundID = cc.audioEngine.play(this.btnSound, false, soundVolume);\r\n        //var btnSoundID = cc.audioEngine.play(this.btnSound, false, GlobalData.soundVolume);\r\n\t\t//退出清空\r\n\t\tthis.cart = [];\r\n\t\tthis.showedCommodityArra = [];\r\n\t\tthis.selectedCategory = 0;\r\n\t\tthis.selectedSubCategory = 0;\r\n\t\tcc.director.loadScene(\"mainPage\");\r\n\t},\r\n\r\n\t//点击小屋按钮的事件处理函数，去到小屋\r\n\tgoHome: function () {\r\n\t\t//播放按键音\r\n        this.btnSound=cc.url.raw('resources/sound/button/1.mp3');\r\n        var soundVolume = 0.5;\r\n        var btnSoundID = cc.audioEngine.play(this.btnSound, false, soundVolume);\r\n        //var btnSoundID = cc.audioEngine.play(this.btnSound, false, GlobalData.soundVolume);\r\n\t\t//退出清空\r\n\t\tthis.cart = [];\r\n\t\tthis.showedCommodityArra = [];\r\n\t\tthis.selectedCategory = 0;\r\n\t\tthis.selectedSubCategory = 0;\r\n\t\tcc.director.loadScene(\"home\");\r\n\t},\r\n\r\n\t/**\r\n     * 打开或者关闭提示框\r\n     * @param {Commodity} promptItem 提示框显示的商品对象\r\n\t * @param {cc.SpriteFrame} promptSp 提示框显示的商品图片\r\n     */\r\n\topenPrompt: function (promptItem, promptSp) {\r\n\t\tthis._isPromptHidden = !this._isPromptHidden;\r\n\t\tlet action = null;\r\n\t\tif (this.selectedCategory == 1 || this.selectedCategory == 2) {\r\n\t\t\tthis.promptIncreaseBtn.node.active = true;\r\n\t\t\tthis.promptDecreaseBtn.node.active = true;\r\n\t\t} else {\r\n\t\t\tthis.promptIncreaseBtn.node.active = false;\r\n\t\t\tthis.promptDecreaseBtn.node.active = true;\r\n\t\t}\r\n\t\tif (!this._isPromptHidden) {\r\n\t\t\tconsole.log(\"open prompt\");\r\n\t\t\t// 将提示框的信息替换为点击的商品\r\n\t\t\tthis.promptUnitPrice = promptItem.price;\r\n\t\t\tthis.promptShowPic.spriteFrame = promptSp;\r\n\t\t\t// 初始购买值设为1\r\n\t\t\tthis.promptQuantity = 1;\r\n\t\t\tthis.promptTotalPrice = 0;\r\n\t\t\t// 打开购买提示框\r\n\t\t\tthis.prompt.active = true;\r\n\r\n\t\t\t// 提示框打开动作部分：\r\n\t\t\t// mask 渐变出来;\r\n\t\t\tvar fin = cc.fadeTo(0.3, 255);\r\n\t\t\tthis.prompt.runAction(fin);\r\n\t\t\t// dlg由小到大\r\n\t\t\tthis.prompt.scale = 0;\r\n\t\t\tvar s = cc.scaleTo(0.4, 1).easing(cc.easeBackOut());\r\n\t\t\tthis.prompt.runAction(s);\r\n\t\t} else {\r\n\t\t\tconsole.log(\"close prompt\");\r\n\t\t\t// 提示框关闭动作部分：\r\n\t\t\tvar fout = cc.fadeOut(0.3);\r\n\t\t\tthis.prompt.runAction(fout);\r\n\t\t\tvar s = cc.scaleTo(0.3, 0).easing(cc.easeBackIn());\r\n\t\t\tvar end_func = cc.callFunc(function () {\r\n\t\t\t\tthis.prompt.active = false;\r\n\t\t\t}.bind(this));\r\n\t\t\tvar seq = cc.sequence([s, end_func]);\r\n\t\t\tthis.prompt.runAction(seq);\r\n\t\t}\r\n\t\t// console.log(this.namePage.node);\r\n\t\tthis.prompt.runAction(action);\r\n\t},\r\n\r\n\t/**\r\n     * 提示框减少按钮被点击\r\n     */\r\n\tonPromptDecreaseBtnClicked: function () {\r\n\t\t//播放按键音\r\n        this.btnSound=cc.url.raw('resources/sound/button/1.mp3');\r\n        var soundVolume = 0.5;\r\n        var btnSoundID = cc.audioEngine.play(this.btnSound, false, soundVolume);\r\n        //var btnSoundID = cc.audioEngine.play(this.btnSound, false, GlobalData.soundVolume);\r\n\t\tthis.promptQuantity -= 1;\r\n\t\tthis.promptTotalPrice = 0;\r\n\t\tif (this.selectedCategory == 1 || this.selectedCategory == 2) {\r\n\t\t\tthis.promptIncreaseBtn.node.active = true;\r\n\t\t\tthis.promptDecreaseBtn.node.active = true;\r\n\t\t} else {\r\n\t\t\tthis.promptIncreaseBtn.node.active = true;\r\n\t\t\tthis.promptDecreaseBtn.node.active = false;\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n     * 提示框增加按钮被点击\r\n     */\r\n\tonPromptIncreaseBtnClicked: function () {\r\n\t\t//播放按键音\r\n        this.btnSound=cc.url.raw('resources/sound/button/1.mp3');\r\n        var soundVolume = 0.5;\r\n        var btnSoundID = cc.audioEngine.play(this.btnSound, false, soundVolume);\r\n        //var btnSoundID = cc.audioEngine.play(this.btnSound, false, GlobalData.soundVolume);\r\n\t\tthis.promptQuantity += 1;\r\n\t\tthis.promptTotalPrice = 0;\r\n\t\tif (this.selectedCategory == 1 || this.selectedCategory == 2) {\r\n\t\t\tthis.promptIncreaseBtn.node.active = true;\r\n\t\t\tthis.promptDecreaseBtn.node.active = true;\r\n\t\t} else {\r\n\t\t\tthis.promptIncreaseBtn.node.active = false;\r\n\t\t\tthis.promptDecreaseBtn.node.active = true;\r\n\t\t}\r\n\t},\r\n\r\n    /**\r\n     * 初始化商店信息\r\n     * @param {object} _data 服务器请求数据经过json转换后的对象\r\n     */\r\n\tinitShop: function (_data) {\r\n\t\tif (_data) {\r\n\t\t\tconsole.log(_data);\r\n\t\t\tlet itemIDArray = _data.itemIDArray.split('+');\r\n\t\t\tlet itemNameArray = _data.itemNameArray.split('+');\r\n\t\t\tlet categoryIDArray = _data.categoryIDArray.split('+');\r\n\t\t\tlet categoryNameArray = _data.categoryNameArray.split('+');\r\n\t\t\tlet priceArray = _data.priceArray.split('+');\r\n\t\t\tlet isOwnArray = _data.ownFlagArray.split('+');\r\n\t\t\tfor (let index = 0; index < itemIDArray.length; index++) {\r\n\t\t\t\tlet commodity = new Commodity(itemIDArray[index], itemNameArray[index], categoryIDArray[index], categoryNameArray[index], priceArray[index], isOwnArray[index]);\r\n\t\t\t\tcommodity.showCategory(1);\r\n\t\t\t\tthis.commodityArray.push(commodity);\r\n\t\t\t\t// console.log(commodity);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n     * 修改商店加载商品类别\r\n     * @param { Number } type 加载商品类别 \r\n     */\r\n\tmodifyShopItemType: function (type) {\r\n\t\tconsole.log('commodity ' + type + ' will be loaded!');\r\n\t\tfor (let i = 0; i < this.commodityArray.length; i++) {\r\n\t\t\tconst element = this.commodityArray[i];\r\n\t\t\telement.showCategory(type);\r\n\t\t}\r\n\t},\r\n\r\n\t/**\r\n     * 加载商店商品\r\n     */\r\n\tloadShopItem: function () {\r\n\t\tlet self = this;\r\n\t\tself.commodityShowBlock.node.destroyAllChildren();\r\n\t\tlet itemNum = 0;\r\n\t\tfor (let i = 0; i < self.commodityArray.length; i++) {\r\n\t\t\tconst element = self.commodityArray[i];\r\n\t\t\t// console.log(\"-----------debug log----------\");\r\n\t\t\t// console.log(\"now load shop item: \" + i);\r\n\t\t\tif (element._isShow) {\r\n\t\t\t\titemNum += 1;\r\n\t\t\t\t// console.log(\"item: \" + i + ' will be loaded');\r\n\t\t\t\tlet picName = 'shopPic/cate' + element.categoryID + '/' + element.id;\r\n\t\t\t\tcc.loader.loadRes(picName, cc.SpriteFrame, (err, sp) => {\r\n\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\tconsole.log('failed to load sprite ' + picName);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcc.loader.loadRes(\"prefab/shopItem\", cc.Prefab, (err, prf) => {\r\n\t\t\t\t\t\tif (err) {\r\n\t\t\t\t\t\t\tconsole.log('error: get prefab' + err + \"prefab/shopItem\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!(prf instanceof cc.Prefab)) {\r\n\t\t\t\t\t\t\tconsole.log(\"not a prefab\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet commodityItem = cc.instantiate(prf);\r\n\r\n\t\t\t\t\t\tcommodityItem.getComponent('shopItem').init(element.price, sp, element._isSoldOut);\r\n\t\t\t\t\t\tcommodityItem.on(\"touchstart\", function () {\r\n\t\t\t\t\t\t\t// console.log(element.name + ' was clicked');\r\n\t\t\t\t\t\t\tself.selectedCommodityIndex = i;\r\n\t\t\t\t\t\t\tif (!element._isSoldOut) {\r\n\t\t\t\t\t\t\t\tself.openPrompt(element, sp);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// console.log(self.commodityArray[self.selectedCommodityIndex].name + ' was clicked,order ' + i);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tcommodityItem.zIndex = i;\r\n\t\t\t\t\t\tself.commodityShowBlock.node.addChild(commodityItem);\r\n\t\t\t\t\t\t// console.log(self.commodityArray[i].name + ' is loading... item: ' + i);\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\tself.commodityShowBlock.node.height = (itemNum % 3) ? ((itemNum - (itemNum % 3)) / 3 + 1) * 130 + (itemNum - (itemNum % 3)) / 3 * 20 : itemNum / 3 * 130 + itemNum / 3 * 20;\r\n\t\tself.shopListView.scrollToTop(0.5);\r\n\t},\r\n\r\n\t// LIFE-CYCLE CALLBACKS:\r\n\r\n\tonLoad() {\r\n\r\n\t\t//初始化\r\n\t\t// this.growthLevel.string = globalData.growthLevel.get();\r\n\t\t// this.coin.string = globalData.coin.get();\r\n\t\t// this.number.string = 1;\r\n\t\t// this.cost.string = 1;\r\n\t\tthis.prompt.active = false;\r\n\t\tthis.selectedCategory = 1;\r\n\t\tthis.subCategory.active = false;\r\n\t\t//与服务器交互，获得所有的商品信息\r\n\r\n\t\tvar url = \"https://www.llquruc.top/petGame/\" + \"php/queryShop.php\"; //服务器接口地址\r\n\t\t// 调用自定义网路接口获取商品信息\r\n\t\tvar self = this;\r\n\t\tvar data = {\r\n\t\t\t\"userID\": \"nqEsLYOCtdRUkx4Ovn8bhDUmnBHB3DdEncp0z7ApU1\"\r\n\t\t};\r\n\t\tHttpHelper.httpPost(url, data, function (data) {\r\n\t\t\tif (data == -1) {\r\n\t\t\t\tconsole.log(\"访问失败\");\r\n\t\t\t} else {\r\n\t\t\t\tself.initShop(data);\r\n\t\t\t\tself.loadShopItem();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tstart() {\r\n\r\n\t},\r\n\r\n\t// update (dt) {},\r\n});\r\n"]}