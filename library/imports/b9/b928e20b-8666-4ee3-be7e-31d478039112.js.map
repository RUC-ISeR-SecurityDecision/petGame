{"version":3,"sources":["..\\..\\..\\..\\assets\\Global/assets\\Global\\net.js"],"names":["HttpHelper","cc","Class","extends","Component","statics","properties","httpGet","url","callback","xhr","loader","getXMLHttpRequest","onreadystatechange","readyState","status","respone","responseText","rsp","JSON","parse","withCredentials","open","sys","isNative","setRequestHeader","myGame","gameManager","getToken","timeout","send","httpPost","params","stringify","httpPostLogin","account","password","str","window","btoa"],"mappings":"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","file":"net.js","sourceRoot":"..\\..\\..\\..\\assets\\Global","sourcesContent":["// 网络请求处理\r\n// author：wang-c\r\n// 三个函数，httpGet,httpPost,httpPostLogin\r\n// httpPostLogin 还需要按照微信小游戏的登录模式修改\r\n// 用法：全局变量window.HttpHelper,使用时只需HttpHelper.httpGet(url, callback) 即可\r\n\r\nconst HttpHelper = cc.Class({\r\n    extends: cc.Component,\r\n \r\n    statics: {\r\n    },\r\n \r\n    properties: {\r\n \r\n    },\r\n \r\n    /**\r\n     * get请求\r\n     * @param {string} url 访问的url\r\n     * @param {function} callback 回调函数, 再函数结束后调用外部函数\r\n     */\r\n    httpGet(url, callback) {\r\n        let xhr = cc.loader.getXMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            // cc.log(\"Get: readyState:\" + xhr.readyState + \" status:\" + xhr.status);\r\n            if (xhr.readyState === 4 && xhr.status == 200) {\r\n                let respone = xhr.responseText;\r\n                let rsp = JSON.parse(respone);\r\n                callback(rsp);\r\n            } else {\r\n                callback(-1);\r\n            }\r\n        };\r\n        xhr.withCredentials = true;\r\n        xhr.open('GET', url, true);\r\n \r\n        if (cc.sys.isNative) {\r\n            xhr.setRequestHeader('Access-Control-Allow-Origin', '*');\r\n            xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET, POST');\r\n            xhr.setRequestHeader('Access-Control-Allow-Headers', 'x-requested-with,content-type,authorization');\r\n            xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n            xhr.setRequestHeader('Authorization', 'Bearer ' + cc.myGame.gameManager.getToken());\r\n            xhr.setRequestHeader('Authorization', 'Bearer ' + \"\");\r\n        }\r\n \r\n        // note: In Internet Explorer, the timeout property may be set only after calling the open()\r\n        // method and before calling the send() method.\r\n        xhr.timeout = 8000;// 8 seconds for timeout\r\n \r\n        xhr.send();\r\n    },\r\n \r\n    /**\r\n     * post请求\r\n     * @param {string} url 请求url\r\n     * @param {object} params 请求参数\r\n     * @param {function} callback 回调函数\r\n     */\r\n    httpPost(url, params, callback) {\r\n        let xhr = cc.loader.getXMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            // cc.log('xhr.readyState=' + xhr.readyState + '  xhr.status=' + xhr.status);\r\n            if (xhr.readyState === 4 && xhr.status == 200) {\r\n                let respone = xhr.responseText;\r\n                let rsp = JSON.parse(respone);\r\n                callback(rsp);\r\n            } else {\r\n                callback(-1);\r\n            }\r\n        };\r\n        xhr.open('POST', url, true);\r\n        // if (cc.sys.isNative) {\r\n        xhr.setRequestHeader('Access-Control-Allow-Origin', '*');\r\n        xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET, POST');\r\n        xhr.setRequestHeader('Access-Control-Allow-Headers', 'x-requested-with,content-type');\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n        // }\r\n \r\n        // note: In Internet Explorer, the timeout property may be set only after calling the open()\r\n        // method and before calling the send() method.\r\n        xhr.timeout = 8000;// 8 seconds for timeout\r\n \r\n        xhr.send(JSON.stringify(params));\r\n    },\r\n \r\n    /**\r\n     * 登录专用\r\n     * @param {string} url \r\n     * @param {object} params \r\n     * @param {function} callback \r\n     * @param {string} account \r\n     * @param {string} password \r\n     */\r\n    httpPostLogin(url, params, callback, account, password) {\r\n        let xhr = cc.loader.getXMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            // cc.log('xhr.readyState=' + xhr.readyState + '  xhr.status=' + xhr.status);\r\n            if (xhr.readyState === 4 && xhr.status == 200) {\r\n                let respone = xhr.responseText;\r\n                let rsp = JSON.parse(respone);\r\n                callback(rsp);\r\n            } else {\r\n                callback(-1);\r\n            }\r\n        };\r\n        xhr.open('POST', url, true);\r\n        xhr.setRequestHeader('Access-Control-Allow-Origin', '*');\r\n        xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET, POST');\r\n        xhr.setRequestHeader('Access-Control-Allow-Headers', 'x-requested-with,content-type');\r\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n        let str = account + \"@\" + password;\r\n        xhr.setRequestHeader('Authorization', 'Basic' + ' ' + window.btoa(str));\r\n \r\n        xhr.timeout = 8000;// 8 seconds for timeout\r\n \r\n        xhr.send(JSON.stringify(params));\r\n \r\n    }\r\n});\r\n \r\nwindow.HttpHelper = new HttpHelper();"]}